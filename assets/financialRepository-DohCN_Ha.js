var x=Object.defineProperty;var b=(r,e,t)=>e in r?x(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var g=(r,e,t)=>b(r,typeof e!="symbol"?e+"":e,t);import{j as c}from"./index-zF6Hmcwz.js";import{b as d,d as p,l as w}from"./vendor-XtUg-c2N.js";const h=d.createContext({striped:!1,hoverable:!1}),i=({children:r,striped:e=!1,hoverable:t=!1,className:n=""})=>c.jsx(h.Provider,{value:{striped:e,hoverable:t},children:c.jsx("div",{className:`overflow-hidden shadow ring-1 ring-secondary-700 ring-opacity-5 sm:rounded-lg ${n}`,children:c.jsx("table",{className:"min-w-full divide-y divide-secondary-700",children:r})})}),S=({children:r,className:e=""})=>c.jsx("thead",{className:`bg-secondary-800 ${e}`,children:r}),N=({children:r,className:e=""})=>{const{striped:t}=d.useContext(h);return c.jsx("tbody",{className:`divide-y divide-secondary-800 bg-secondary-800 ${e}`,children:p.Children.map(r,(n,s)=>p.isValidElement(n)?p.cloneElement(n,{...n.props,isEven:t&&s%2===0}):n)})},I=({children:r,className:e="",isEven:t=!1})=>{const{hoverable:n}=d.useContext(h);return c.jsx("tr",{className:`
      ${t?"bg-secondary-700":""}
      ${n?"hover:bg-secondary-600 transition-colors":""}
      ${e}
    `,children:r})},$=({children:r,className:e="",align:t="left"})=>{const n={left:"text-left",center:"text-center",right:"text-right"};return c.jsx("th",{scope:"col",className:`px-6 py-3 text-xs font-medium uppercase tracking-wider text-secondary-100 ${n[t]} ${e}`,children:r})},D=({children:r,className:e="text-secondary-100",align:t="left",colSpan:n})=>{const s={left:"text-left",center:"text-center",right:"text-right"};return c.jsx("td",{className:`whitespace-nowrap px-6 py-4 text-sm ${s[t]} ${e}`,colSpan:n,children:r})};i.Head=S;i.Body=N;i.Row=I;i.HeaderCell=$;i.Cell=D;const y={CURRENCY:"currency",STOCK:"stock",BITCOIN:"bitcoin"},E={[y.CURRENCY]:"Moeda",[y.STOCK]:"Ação",[y.BITCOIN]:"Cripto"},V=({type:r})=>c.jsx(i.Cell,{children:E[r]}),R=(r="USD",e=0)=>{const t=T(e)/100,s={USD:{locale:"en-US",currency:"USD",symbol:"$"},BRL:{locale:"pt-BR",currency:"BRL",symbol:"R$"},EUR:{locale:"de-DE",currency:"EUR",symbol:"€"},GBP:{locale:"en-GB",currency:"GBP",symbol:"£"},JPY:{locale:"ja-JP",currency:"JPY",symbol:"¥"},CNY:{locale:"zh-CN",currency:"CNY",symbol:"¥"},AUD:{locale:"en-AU",currency:"AUD",symbol:"A$"},CAD:{locale:"en-CA",currency:"CAD",symbol:"C$"},CHF:{locale:"de-CH",currency:"CHF",symbol:"CHF"},INR:{locale:"en-IN",currency:"INR",symbol:"₹"}}[r]||{locale:"en-US",currency:r};try{return new Intl.NumberFormat(s.locale,{style:"currency",currency:s.currency,minimumFractionDigits:2,maximumFractionDigits:2}).format(t)}catch(o){return console.error(`Erro ao formatar valor para a moeda ${r}: ${o}`),`${s.symbol||r} ${t.toFixed(2)}`}},T=r=>Math.round(r*100),A=(r=0,e="en-US")=>{let t=2;return r>=1e3||r>=100?t=2:r>=10?t=3:t=4,new Intl.NumberFormat(e,{minimumFractionDigits:t,maximumFractionDigits:t}).format(r)},L=({type:r,source:e,buy:t,points:n})=>c.jsx(i.Cell,{children:r!==y.STOCK?`${R(e,t)||"-"}`:A(n)||"-"}),W=({variation:r})=>{const e=t=>t>0?"text-green-500":t<0?"text-red-500":"text-secondary-300";return c.jsxs(i.Cell,{className:e(r),children:[r.toFixed(2),"%"]})},j=3*60*1e3;class v{constructor(){g(this,"cache",new Map)}get(e){const t=this.cache.get(e);return t?Date.now()-t.timestamp>j?(this.cache.delete(e),null):t.data:null}set(e,t){this.cache.set(e,{data:t,timestamp:Date.now()})}getExpired(e){const t=this.cache.get(e);return t?t.data:null}clear(e){e?this.cache.delete(e):this.cache.clear()}}const l=new v,H="8073a3d2",O=r=>{const e=w.create({baseURL:r,headers:{"Content-Type":"application/json"}});return e.interceptors.response.use(t=>t,t=>Promise.reject(t)),e},u=(r,e)=>e?`${r}?format=json-cors&key=${e}`:(console.warn("API key is not set. Requests might fail."),r),m=r=>{var e;throw console.error("API Error:",((e=r.response)==null?void 0:e.data)||r.message),r},U=(r,e=H)=>{const t=O(r);return{async get(n,s){try{const o=u(n,e);return(await t.get(o,s)).data}catch(o){return m(o)}},async post(n,s,o){try{const a=u(n,e);return(await t.post(a,s,o)).data}catch(a){return m(a)}},async put(n,s,o){try{const a=u(n,e);return(await t.put(a,s,o)).data}catch(a){return m(a)}},async delete(n,s){try{const o=u(n,e);return(await t.delete(o,s)).data}catch(o){return m(o)}}}},F=U("https://api.hgbrasil.com"),P={getQuotations:()=>"/finance"};class Q{async fetchQuotations(){return await F.get(P.getQuotations())}}const B=new Q;class Y{saveQuotationHistory(e){const t=new Date,n=JSON.parse(localStorage.getItem(`history_${e.id}`)||"[]");n.push({...e,timestamp:t.getTime()}),localStorage.setItem(`history_${e.id}`,JSON.stringify(n))}getQuotationHistory(e){return JSON.parse(localStorage.getItem(`history_${e}`)||"[]")}}const C=new Y;class _{mapResponseToFinancialData(e){const t=e.results,{source:n="USD"}=t.currencies||{},s=this.mapCurrencies(t.currencies||{},n.toString()),o=this.mapStocks(t.stocks||{}),a=this.mapBitcoin(t.bitcoin||{},n.toString());return[...s,...o,...a]}mapCurrencies(e,t){return Object.entries(e).filter(([n])=>n!=="source").map(([n,s])=>({id:n,source:t,name:s.name,buy:s.buy,sell:s.sell,variation:s.variation,type:"currency"})).slice(0,3)}mapStocks(e){return Object.entries(e).map(([t,n])=>({id:t,name:n.name,location:n.location,points:n.points,variation:n.variation,type:"stock"})).slice(0,3)}mapBitcoin(e,t){return Object.entries(e).map(([n,s])=>({id:n,name:s.name,source:t,buy:s.buy,sell:s.sell,variation:s.variation,type:"bitcoin"})).slice(0,4)}}const k=new _,G={async getQuotations(){const r="quotations";try{const e=l.get(r);if(e)return e;const t=await B.fetchQuotations(),n=k.mapResponseToFinancialData(t);return l.set(r,n),n}catch(e){console.error("Erro ao buscar cotações:",e);const t=l.getExpired(r);return t||[]}},clearCache(r){l.clear(r)},saveQuotationHistory(r){C.saveQuotationHistory(r)},getQuotationHistory(r){return C.getQuotationHistory(r)}};export{E as Q,i as T,L as V,V as a,W as b,y as c,A as d,G as e,R as f};
//# sourceMappingURL=financialRepository-DohCN_Ha.js.map
