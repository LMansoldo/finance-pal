import{j as e,L as f,r as i,R as y}from"./index-BjDnKuFi.js";import{T as t,a as b,V as w,b as v,Q as N,c as h,f as j,d as C,e as p}from"./financialRepository-BGMgg14-.js";const R=({name:s})=>e.jsx(t.Cell,{children:e.jsx("div",{className:"font-medium",children:s})}),T=({id:s})=>e.jsx(t.Cell,{children:e.jsxs(f,{to:`/detail/${s}`,className:"text-blue-400 hover:text-blue-300 text-sm font-medium flex items-center",children:["Ver detalhes",e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 ml-1",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10.293 5.293a1 1 0 011.414 0l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414-1.414L12.586 11H5a1 1 0 110-2h7.586l-2.293-2.293a1 1 0 010-1.414z",clipRule:"evenodd"})})]})}),E=[{id:"name",label:"Nome"},{id:"type",label:"Tipo"},{id:"value",label:"Valor"},{id:"variation",label:"Variação"},{id:"actions",label:"Ações"}],x=({width:s="100%",height:r="1.25rem",borderRadius:l="0.25rem",className:a=""})=>{const n=typeof s=="number"?`${s}px`:s,c=typeof r=="number"?`${r}px`:r;return e.jsx("div",{className:`bg-secondary-500 animate-pulse ${a}`,style:{width:n,height:c,borderRadius:l}})},V=({quotations:s,loading:r,error:l})=>e.jsxs(t,{striped:!0,hoverable:!0,children:[e.jsx(t.Head,{children:e.jsx(t.Row,{children:E.map(a=>e.jsx(t.HeaderCell,{children:a.label},a.id))})}),e.jsxs(t.Body,{children:[r&&e.jsx(e.Fragment,{children:[...Array(10)].map((a,n)=>e.jsx(t.Row,{children:e.jsx(t.Cell,{colSpan:5,children:e.jsx(x,{})})},`${a}-${n}`))}),l&&e.jsx(t.Row,{children:e.jsx(t.Cell,{colSpan:5,children:"Erro ao carregar dados."})}),s.length===0&&!l&&!r&&e.jsx(t.Row,{children:e.jsx(t.Cell,{colSpan:5,children:"Nenhum dado encontrado."})}),s.map(a=>e.jsxs(t.Row,{children:[e.jsx(R,{name:a.name}),e.jsx(b,{type:a.type}),e.jsx(w,{type:a.type,buy:a.buy,points:a.points,source:a.source}),e.jsx(v,{variation:a.variation}),e.jsx(T,{id:a.id})]},a.id))]})]}),L=({name:s,type:r})=>e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-secondary-100 truncate",children:s}),e.jsx("span",{className:"text-xs font-medium px-2 py-1 rounded-full bg-secondary-500 text-secondary-200",children:N[r]||r})]}),u=({label:s,value:r,className:l="text-secondary-100"})=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-sm text-secondary-200",children:[s,":"]}),e.jsx("span",{className:`text-base font-medium ${l}`,children:r})]}),I=({variation:s})=>{const r=l=>l?l>0?"text-green-600":l<0?"text-red-600":"text-secondary-600":"text-secondary-100";return e.jsx(u,{label:"Variação",value:s!==void 0?`${s>0?"+":""}${s.toFixed(2)}%`:"-",className:r(s)})},F=({quotation:s})=>{const r=l=>l.type!==h.STOCK?l.buy?j(l.source,l.buy):"-":l.points?C(l.points):"-";return e.jsxs("div",{className:"flex-grow space-y-2",children:[e.jsx(u,{label:"Valor",value:r(s)}),(s.type===h.CURRENCY||s.type===h.BITCOIN)&&e.jsx(u,{label:"Venda",value:s.sell?j(s.source,s.sell):"-"}),s.type===h.STOCK&&s.location&&e.jsx(u,{label:"Local",value:s.location}),e.jsx(I,{variation:s.variation})]})},S=({id:s})=>e.jsx("div",{className:"mt-4 pt-3 border-t border-secondary-700 flex justify-end",children:e.jsxs(f,{to:`/detail/${s}`,className:"text-primary-400 hover:text-primary-300 text-sm font-medium flex items-center",children:["Ver detalhes",e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 ml-1",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10.293 5.293a1 1 0 011.414 0l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414-1.414L12.586 11H5a1 1 0 110-2h7.586l-2.293-2.293a1 1 0 010-1.414z",clipRule:"evenodd"})})]})}),A=s=>r=>e.jsx("div",{className:"bg-secondary-800 rounded-lg shadow-md p-4 flex flex-col h-full border border-secondary-600 hover:border-secondary-500 transition-colors",children:e.jsx(s,{...r})}),$=({quotation:s})=>e.jsxs(e.Fragment,{children:[e.jsx(L,{name:s.name,type:s.type}),e.jsx(F,{quotation:s}),e.jsx(S,{id:s.id})]}),H=A($),B=({quotations:s,loading:r,error:l})=>r?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 p-4 w-full",children:Array.from({length:6}).map((a,n)=>e.jsxs("div",{className:"p-4 bg-secondary-800 rounded shadow w-full",children:[e.jsx(x,{height:"150px",className:"mb-4"}),e.jsx(x,{height:"20px",width:"60%"}),e.jsx(x,{height:"20px",width:"80%"}),e.jsx(x,{height:"20px",width:"40%"})]},n))}):l?e.jsx("div",{className:"text-center mt-4",children:"Nenhum dado encontrado."}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 p-4 w-full",children:s.map(a=>e.jsx(H,{quotation:a},a.id))}),O=()=>{const[s,r]=i.useState(!1),[l,a]=i.useState([]),[n,c]=i.useState(null),d=i.useRef(null),o=async()=>{r(!0),c(null);try{const m=await p.getQuotations();a(m),m.forEach(g=>{p.saveQuotationHistory(g)})}catch(m){c(m)}finally{r(!1)}};return i.useEffect(()=>(o(),d.current=setInterval(o,3e5),()=>{d.current&&clearInterval(d.current)}),[]),{loading:s,quotations:l,error:n}},Q=y.memo(({loading:s,quotations:r,error:l})=>e.jsx("div",{className:"grid grid-cols-1 gap-4",children:e.jsx(B,{quotations:r,loading:s,error:l})})),M=y.memo(({loading:s,quotations:r,error:l})=>e.jsx("div",{className:"bg-white shadow overflow-x sm:rounded-lg mb-6",children:e.jsx(V,{quotations:r,loading:s,error:l})})),_=()=>{const{loading:s,quotations:r,error:l}=O(),[a,n]=i.useState(!1);return i.useLayoutEffect(()=>{const c=()=>{n(window.innerWidth<1024)};c();let d;const o=()=>{clearTimeout(d),d=window.setTimeout(c,100)};return window.addEventListener("resize",o),()=>{clearTimeout(d),window.removeEventListener("resize",o)}},[]),e.jsx("div",{className:"min-h-screen bg-secondary-900",children:e.jsx("main",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:a?e.jsx(Q,{quotations:r,loading:s,error:l}):e.jsx(M,{quotations:r,loading:s,error:l})})})},D=()=>e.jsx(_,{});export{D as default};
